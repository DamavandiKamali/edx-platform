<%! from django.utils.translation import ugettext as _ %>
<!--<%namespace name='static' file='/static_content.html'/>-->

<!--<%inherit file="../main.html" />-->

<%block name="pagetitle">${_("Account Settings")}</%block>

<%block name="js_extra">
    <script type="text/javascript" src="${static.url('js/vendor/underscore-min.js')}"></script>
    <script type="text/javascript" src="${static.url('js/vendor/backbone-min.js')}"></script>

     <script type="text/javascript" src="${static.url('js/student_account/views/AccountSettingsView.js')}"></script>
     <script type="text/javascript" src="${static.url('js/student_account/models/AccountSettingsModel.js')}"></script>

    <%static:js group='student_account'/>
</%block>

<%block name="header_extras">
    % for template_name in ["account_settings", "field_dropdown", "field_link", "field_readonly", "field_text"]:
        <script type="text/template" id="${template_name}-tpl">
            <%static:include path="student_account/${template_name}.underscore" />
        </script>
    % endfor
</%block>

<%block name="content">
    <div class="wrapper-mast wrapper">
        <header class="mast has-actions has-subtitle">
            <h1 class="page-header">
                ${_("Account Settings")}
            </h1>
            <small class="subtitle">${_("A collection of all your account settings, including basic personalization controls, demographic information, and linked social accounts.")}</small>
        </header>
    </div>

    <div class="account-settings-container"
         data-accounts-api-url="${accounts_api_url}"
    ></div>
</%block>

<%block name="headextra">
    <script>
        $(document).ready(function() {
            var accountSettingsElement = $('.account-settings-container');
            var accountSettingsModel = new edx.student.account.AccountSettingsModel();
            accountSettingsModel.url = accountSettingsElement.data('accounts-api-url');
            var accountSettingsView = new edx.student.account.AccountSettingsView({
                el: accountSettingsElement,
                model: accountSettingsModel,
                context: {
                    accountSettingsModelUrl: accountSettingsModel.url
                },
                sections : [
                    {
                        title: "Basic Account Information",
                        fields: [
                            {
                                view: new edx.student.account.ReadonlyFieldView({
                                    model: accountSettingsModel,
                                    title: "Username",
                                    value_attribute: "username",
                                    message: ""
                                })
                            },
                            {
                                view: new edx.student.account.TextFieldView({
                                    model: accountSettingsModel,
                                    title: "Full Name",
                                    value_attribute: "name",
                                    message: "This is used on your edX certificates, and all changes are reviewed."
                                })
                            },
                            {
                                view: new edx.student.account.TextFieldView({
                                    model: accountSettingsModel,
                                    title: "Email",
                                    value_attribute: "email",
                                    message: "You account email is used as a login mechanism and for course communications."
                                })
                            },
                            {
                                view: new edx.student.account.LinkFieldView({
                                    model: accountSettingsModel,
                                    title: "Password",
                                    link_title: "Reset Password",
                                    link_href: "#",
                                    message: "To reset your password you'll need to click the reset password link sent to you via email."
                                })
                            },
                            {
                                view: new edx.student.account.DropdownFieldView({
                                    model: accountSettingsModel,
                                    title: "Language",
                                    message: "This setting controls your default edX language."
                                })
                            },
                        ]
                    },
                    {
                        title: "Demographics and Additional Details",
                    },
                    {
                        title: "Connected Accounts",
                    }
                ]
            });

            accountSettingsModel.fetch().done(function() {
                accountSettingsView.render();
            });
        });
    </script>
</%block>
